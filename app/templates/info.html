<nav class="centered navbar navbar-default navbar-fixed-top" role="navigation">

    <div class="bdtem-title">

            <span style="font-size: 1.8vmin; letter-spacing: 0.6vw">
                WELCOME TO THE DEPARTMENT OF ARCHIVES
            </span>

        <br/>

        <div class="bdtem-subtitle sans-serif-light">
            PROJECT NO. 2.0013.B-9.006.1289.11<br/>
            AKA<br/>
        </div>

        <b class="bdtem-title">BOB DEY'S TANK ENGINE MAN</b>
    </div>

</nav>

<div class=" ui-view-wide">
    <svg height="100%" version="1.1" width="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 600"
         id="info-graphic"
         margin="0 auto" preserveAspectRatio="none" style="display: block;">

        <!--<path d="M0 100 H 600-->
        <!--M0 120 H 600-->
        <!--M0 140 H 600-->
        <!--M0 160 H 600-->
        <!--M0 180 H 600-->
        <!--M0 200 H 600-->
        <!--M0 220 H 600-->
        <!--M0 240 H 600-->
        <!--M0 260 H 600-->
        <!--M0 280 H 600-->
        <!--M0 300 H 600-->
        <!--M0 320 H 600-->
        <!--M0 340 H 600-->
        <!--M0 360 H 600-->
        <!--M0 380 H 600-->
        <!--M0 400 H 600-->
        <!--M0 420 H 600"-->
        <!--stroke="#000" stroke-width="1"/>-->

        <g id="mission" class="info-page-letter">
            <text class="info-page-small" style="text-anchor: middle" x="4.5%" y="49.5%">MISS</text>
            <!--
                                        -->
            <text x="5.5%" y="33%" fill="#F0F0F0" class="info-page">I</text>
            <!--
                                        -->
            <text class="info-page-small" style="text-anchor: middle" x="14.5%" y="49.5%">ON</text>
        </g>

        <g id="analysis" class="info-page-letter">
            <text class="info-page-small" style="text-anchor: middle" x="22%" y="59.5%">
                <tspan dx="14%">A</tspan>
                <tspan dx="19%">ALYSIS</tspan>
            </text>
            <!--
                        -->
            <text x="20%" y="33%" fill="#F0F0F0" class="info-page">N</text>
        </g>

        <g id="faq" class="info-page-letter">
            <text x="50%" y="33%" fill="#F0F0F0" class="info-page">F</text>
            <!--
                        -->
            <text class="info-page-small" style="text-anchor: middle" x="59.5%" y="49.5%">AQ</text>
        </g>

        <g id="about" class="info-page-letter">
            <text class="info-page-small" style="text-anchor: middle" x="74%" y="59.5%">AB</text>
            <!--
                     -->
            <text x="72%" y="33%" fill="#F0F0F0" class="info-page">O</text>
            <!--
                     -->
            <text class="info-page-small" style="text-anchor: middle" x="94.5%" y="59.5%">UT</text>
        </g>

        <path d="M0 100 H 600
        M0 120 H 600
        M0 140 H 600
        M0 160 H 600
        M0 180 H 600
        M0 200 H 600
        M0 220 H 600
        M0 240 H 600
        M0 260 H 600
        M0 280 H 600
        M0 300 H 600
        M0 320 H 600
        M0 340 H 600
        M0 360 H 600
        M0 380 H 600
        M0 400 H 600
        M0 420 H 600"
              stroke="#000" stroke-width="1"/>

        <rect class="info-page-cover" x="0%" y="0%" width="20%"
              onmouseover="highlightAllExcept('#mission')"
              onmouseout="resetAllLetters()"></rect>
        <rect class="info-page-cover" x="20%" y="0%" width="25%"
              onmouseover="highlightAllExcept('#analysis')"
              onmouseout="resetAllLetters()"></rect>
        <rect class="info-page-cover" x="45%" y="0%" width="25%"
              onmouseover="highlightAllExcept('#faq')"
              onmouseout="resetAllLetters()"></rect>
        <rect class="info-page-cover" x="70%" y="0%" width="30%"
              onmouseover="highlightAllExcept('#about')"
              onmouseout="resetAllLetters()"></rect>

    </svg>
</div>

<script>
    var letters = [];
    var largeLetters = [];

    //Letter color animation:
    var animation;
    var startColor = 0xFA;
    var endColor = 0xFF;
    var currentFill = startColor;
    var currentFillString = toGrayscaleColorString(startColor);

    $(document).ready(function () {
        setTimeout(function () {
            letters = $('.info-page-letter');
            largeLetters = $('.info-page').toArray();
            animation = animateColor();
        }, 0);
    });


    function highlightAllExcept(groupSelector) {
        animation && animation.pause();

        var elem = $(groupSelector);
        var idToSkip = elem[0].id;
        for (var i = 0; i < letters.length; i++) {
            var id = letters[i].id;
            if (id != idToSkip) {
                letters[i].style['display'] = 'none';
            } else {
                var infoPageBigLetter = $(letters[i]).find(INFO_PAGE_CLASS);

                infoPageBigLetter[0].attributes['fill'].value = '#000';

            }
        }
    }

    const INFO_PAGE_CLASS = '.info-page';
    function resetAllLetters() {
        //Hacky Workaround for https://github.com/adobe-webplatform/Snap.svg/issues/139
        Snap.select(INFO_PAGE_CLASS).animate({dummy: 0}, 1);
        animation && animation.resume();

        letters.map(function reset(idx, elem) {
            var elementSelector = $(elem);
            elementSelector[0].style['display'] = 'inline-block';
            elementSelector.find(INFO_PAGE_CLASS)[0].attributes['fill'].value = toGrayscaleColorString(currentFill);
        })
    }

    function animateColor() {
        return Snap.animate(
                startColor,
                endColor,
                updateColor,
                10000,
                function swapAndLoop() {
                    endColor = startColor;
                    startColor = currentFill;
                    animation = animateColor();
                }
        )
    }

    function updateColor(value) {
        var newValue = Math.floor(value);

        if (newValue != currentFill) {
            currentFill = newValue;
            currentFillString = toGrayscaleColorString(newValue);
            largeLetters.forEach(letterUpdateFunction);
        }

    }

    function letterUpdateFunction(elem) {
        $(elem).attr('fill', currentFillString);
    }

    function toGrayscaleColorString(value) {
        var asString = value.toString(16);
        return '#' + asString + asString + asString;
    }


</script>